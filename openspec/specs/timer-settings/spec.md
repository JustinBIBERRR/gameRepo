# timer-settings Specification

## Purpose
TBD - created by archiving change add-game-timer. Update Purpose after archive.
## Requirements
### Requirement: 全局设置页面入口
系统 SHALL 在导航栏提供设置页面入口，允许用户访问全局设置页面。

#### Scenario: 用户访问设置入口
- **WHEN** 用户在任意页面
- **THEN** 在导航栏显示设置图标
- **AND** 设置图标清晰可见，不干扰主要内容

#### Scenario: 用户点击设置入口
- **WHEN** 用户点击导航栏设置图标
- **THEN** 导航到独立的设置页面（/settings）
- **AND** 显示全局设置界面

### Requirement: 全局设置页面
系统 SHALL 提供独立的全局设置页面，包含全局默认设置和游戏类型覆盖设置。

#### Scenario: 显示全局默认设置
- **WHEN** 用户进入设置页面
- **THEN** 显示全局默认设置区域（顶部）
- **AND** 包含以下配置项：
  - 倒计时时长（1-60分钟，默认5分钟）
  - 最大尝试次数（3-10次，默认5次）
  - 是否显示初始提示（默认开启）

#### Scenario: 显示游戏类型覆盖设置
- **WHEN** 用户进入设置页面
- **THEN** 显示游戏类型覆盖区域（下方）
- **AND** 为城市猜测和英雄猜测分别提供配置项
- **AND** 每个游戏类型的配置项可覆盖全局默认值
- **AND** 游戏类型覆盖区域可折叠

### Requirement: 倒计时时长设置
系统 SHALL 允许用户设置倒计时时长，范围为1-60分钟，默认值为5分钟。

#### Scenario: 用户设置全局默认倒计时时长
- **WHEN** 用户在设置页面修改全局默认倒计时时长
- **THEN** 系统验证输入值在1-60分钟范围内
- **AND** 如果输入无效，显示错误提示
- **AND** 如果输入有效，保存设置到 localStorage

#### Scenario: 用户设置游戏类型覆盖倒计时时长
- **WHEN** 用户在设置页面修改特定游戏的倒计时时长
- **THEN** 系统验证输入值在1-60分钟范围内
- **AND** 如果输入无效，显示错误提示
- **AND** 如果输入有效，保存游戏类型覆盖设置到 localStorage
- **AND** 该游戏的倒计时使用覆盖值，其他游戏使用全局默认值

### Requirement: 最大尝试次数设置
系统 SHALL 允许用户设置最大尝试次数，范围为3-10次，默认值为5次。

#### Scenario: 用户设置全局默认尝试次数
- **WHEN** 用户在设置页面修改全局默认最大尝试次数
- **THEN** 系统验证输入值在3-10次范围内
- **AND** 如果输入无效，显示错误提示
- **AND** 如果输入有效，保存设置到 localStorage

#### Scenario: 用户设置游戏类型覆盖尝试次数
- **WHEN** 用户在设置页面修改特定游戏的最大尝试次数
- **THEN** 系统验证输入值在3-10次范围内
- **AND** 如果输入无效，显示错误提示
- **AND** 如果输入有效，保存游戏类型覆盖设置到 localStorage
- **AND** 该游戏的最大尝试次数使用覆盖值，其他游戏使用全局默认值

### Requirement: 设置持久化
系统 SHALL 将全局设置保存到 localStorage，并在页面刷新后保持。

#### Scenario: 保存全局设置
- **WHEN** 用户修改全局默认设置并确认
- **THEN** 设置保存到 localStorage（包含全局默认值和游戏类型覆盖）
- **AND** 页面刷新后设置仍然有效

#### Scenario: 读取游戏配置
- **WHEN** 用户进入游戏页面
- **THEN** 系统从 localStorage 读取游戏配置
- **AND** 优先使用游戏类型覆盖值，如果没有覆盖则使用全局默认值
- **AND** 如果 localStorage 中没有设置，使用系统默认值（倒计时5分钟，尝试次数5次，初始提示开启）

### Requirement: 设置实时更新
系统 SHALL 在用户修改设置后立即更新当前游戏的倒计时（如果游戏正在进行）。

#### Scenario: 游戏进行中修改设置
- **WHEN** 用户在游戏进行中修改倒计时设置
- **THEN** 当前游戏的倒计时立即重置为新设置的值
- **AND** 倒计时重新开始计时

#### Scenario: 游戏未开始时修改设置
- **WHEN** 用户在游戏未开始时修改倒计时设置
- **THEN** 设置仅保存，不启动倒计时
- **AND** 下次开始游戏时使用新设置

### Requirement: 倒计时开关配置UI
设置页面 SHALL 提供一行式UI交互，允许用户同时配置倒计时开关和时长。

#### Scenario: 全局默认倒计时开关配置
- **GIVEN** 用户在设置页面的"全局默认设置"区域
- **WHEN** 查看倒计时配置
- **THEN** 显示一行包含：复选框"启用倒计时" + 输入框"时长（分钟）"
- **AND** 复选框默认勾选
- **AND** 输入框默认值为 5 分钟

#### Scenario: 取消勾选时输入框禁用
- **GIVEN** 倒计时复选框已勾选
- **AND** 时长输入框为可用状态
- **WHEN** 用户取消勾选复选框
- **THEN** 时长输入框变为禁用状态（灰色）
- **AND** 输入框中的数值保留不变

#### Scenario: 重新勾选时输入框恢复
- **GIVEN** 倒计时复选框未勾选
- **AND** 时长输入框为禁用状态，显示之前的值（如 5）
- **WHEN** 用户重新勾选复选框
- **THEN** 时长输入框恢复为可用状态
- **AND** 输入框中的数值保持不变

#### Scenario: 游戏类型覆盖倒计时开关配置
- **GIVEN** 用户在设置页面的"游戏类型覆盖"区域
- **WHEN** 展开某个游戏类型（如"电影猜测"）
- **THEN** 显示倒计时开关复选框和时长输入框
- **AND** 提示文字说明"留空使用全局默认"

### Requirement: 电影注册表单
设置页面的电影注册表单 SHALL 支持配置初始提示，帮助用户为每部电影设置游戏提示。

#### Scenario: 添加电影时配置初始提示
- **GIVEN** 用户点击"添加电影"按钮
- **WHEN** 显示添加电影表单
- **THEN** 表单包含"初始提示"输入框
- **AND** 输入框为可选字段（非必填）
- **AND** 占位符文本为"例如：漫威、国产动画、香港警匪片"
- **AND** 输入框下方显示提示："建议10字以内，让提示更精炼"

#### Scenario: 输入超过10字时显示警告
- **GIVEN** 用户在"初始提示"输入框中输入文本
- **WHEN** 输入字符数超过 10 字
- **THEN** 输入框下方显示黄色警告文字
- **AND** 警告内容为"(当前 X 字，建议精简)"
- **AND** 不阻止用户继续输入（软限制）

#### Scenario: 电影列表显示提示配置状态
- **GIVEN** 用户在设置页面查看已注册的电影列表
- **WHEN** 某部电影未配置 `hint` 字段
- **THEN** 在电影信息中显示"未设置提示"标记
- **WHEN** 某部电影已配置 `hint` 字段
- **THEN** 在电影信息中显示提示内容（如"提示：漫威"）

#### Scenario: 保存电影时处理空提示
- **GIVEN** 用户在添加/编辑电影时未填写"初始提示"
- **WHEN** 保存电影
- **THEN** `hint` 字段保存为 `undefined` 或空字符串
- **AND** 不影响电影的正常保存和使用

