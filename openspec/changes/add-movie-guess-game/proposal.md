# Change: 添加听片段猜电影游戏

## Why
为游戏平台添加一个新的游戏类型：听片段猜电影。用户通过听电影音频片段来猜测电影名称，增加游戏的趣味性和挑战性。该游戏需要支持视频播放、音频提取、时间点选择等多媒体功能。

## What Changes
- 创建电影猜测游戏（MovieGuess.vue）
- 实现视频播放器组件，支持两种播放模式：
  - **快速模式**：使用关键片段（每5-10分钟一个15秒片段），1-3秒加载
  - **精确模式**：使用原文件（30GB+），支持任意时间点，30秒内开始播放
- 实现智能播放模式选择（自动判断或用户选择）
- 实现音频播放功能（猜测阶段只播放音频，不显示视频）
- 实现时间点选择器（时间轴拖拽 + 数字输入，实时同步）
- 实现15秒音频片段播放功能（支持播放次数限制）
- 创建电影数据文件（包含知名国产电影，如：哪吒之魔童降世、无间道、我不是药神等）
- 实现本地文件管理（IndexedDB存储File对象，支持关键片段和原文件）
- 实现猜测历史记录和回顾功能（游戏结束后可查看每次选择的视频片段）
- 集成到平台路由系统
- 在设置页面添加电影猜测游戏的配置选项：
  - 最大尝试次数（默认8次）
  - 每个片段最大播放次数（可配置）
  - 本地电影文件管理（选择关键片段目录和/或原文件）
  - 播放模式偏好（快速/精确/自动）
- 实现游戏状态持久化（sessionStorage）
- 集成倒计时功能（复用现有倒计时系统）
- 集成游戏统计和成就系统

## Impact
- Affected specs:
  - `movie-guess-game` - 电影猜测游戏（新增）
  - `platform-core` - 平台核心（修改：添加游戏入口）
  - `timer-settings` - 倒计时设置（修改：添加电影游戏配置）
- Affected code:
  - `src/views/MovieGuess.vue` - 新建电影猜测游戏页面
  - `src/components/VideoPlayer.vue` - 新建视频播放器组件（支持快速/精确模式）
  - `src/components/TimeSelector.vue` - 新建时间点选择器组件（时间轴+数字输入）
  - `src/data/movies.json` - 新建电影数据文件
  - `src/utils/movieUtils.ts` - 新建电影工具函数（包含智能播放模式选择逻辑）
  - `src/utils/storageUtils.ts` - 添加IndexedDB支持（存储本地电影文件）
  - `src/router/index.ts` - 添加电影猜测游戏路由
  - `src/views/Home.vue` - 添加电影猜测游戏卡片
  - `src/views/Settings.vue` - 添加电影猜测游戏配置选项（文件管理、播放模式）
  - `src/components/Navigation.vue` - 无需修改（自动支持新路由）

## 技术亮点

### 混合播放方案
- **关键片段（快速路径）**：每5-10分钟一个15秒片段，1-3秒加载，覆盖主要时间点
- **原文件（精确路径）**：支持任意时间点，使用Range请求按需加载，30秒内开始播放
- **智能选择**：自动判断或用户选择播放模式，兼顾性能和灵活性

### 性能优化
- 使用 `preload="metadata"` 快速加载元数据（<2秒）
- 浏览器自动Range请求，按需加载视频数据
- 边加载边播放，`canplay` 事件触发时立即开始
- 显示加载进度和预计时间，提升用户体验

### 用户体验
- 快速模式：1-3秒加载，时间点可能偏离±2.5分钟
- 精确模式：10-30秒加载，完全精确的时间点
- 自动模式：系统智能选择最优方案
